srcdir=         @srcdir@
top_srcdir=     @top_srcdir@
top_builddir=   @top_builddir@
VPATH=          @srcdir@

include ${top_builddir}/Mk/autoconf.mk
include ${top_builddir}/Mk/compile.mk
include ${top_builddir}/Mk/subdir.mk

LIB_OBJS=	TRAuthLDAPConfig.o \
		TRConfig.o \
		TRConfigLexer.o \
		TRConfigParser.o \
		TRConfigToken.o \
		TRLDAPGroupConfig.o \

GEN_SRCS=	TRConfigParser.m \
		TRConfigParser.h \
		TRConfigLexer.m

LIB=	libauth-ldap-config.a

# Work-around for gnumake bug.
# It fails to check if 'TRConfigParser.h' has been created
# after lemon has been called, and goes looking for a
# rule to build it.
TRConfigParser.h: TRConfigParser.m


all:: $(LIB)

$(LIB): $(GEN_SRCS) $(LIB_OBJS)
	$(AR) -r $@ $(LIB_OBJS)

clean::
	rm -f $(GEN_SRCS) $(LIB_OBJS) $(LIB)

distclean:: clean
	rm -f Makefile
